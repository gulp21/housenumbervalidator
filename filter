#!/bin/bash

osmconvert="osmconvert"
osmfilter="osmfilter"

echo ------------------
start=`date +%H:%M:%S`
echo `date +%H:%M:%S` creating $1.hnr.osm
echo ------------------

echo osmconvert…
$osmconvert $1 --max-objects=40000000 --hash-memory=100 --all-to-nodes --drop-relations --out-o5m > $1.o5m
if [ ! $? -eq 0 ]; then
	exit -1
fi
echo osmfilter…
$osmfilter $1.o5m --hash-memory=100 --keep-nodes="addr:*=" --keep-tags="all addr:*= shop= amenity= tourism= name= operator= power=sub_station street_lamp note= fixme= NOTE= FIXME=" -o=$1.hnr.osm
if [ ! $? -eq 0 ]; then
	exit -2
fi
rm $1.o5m

echo ------------------
echo  $start-`date +%H:%M:%S` filter finished
echo ------------------
exit 0
